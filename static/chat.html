<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ—…éŠåŠ©æ‰‹ â€” äº’å‹•è¦åŠƒ</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg mb-3" style="background:linear-gradient(90deg,#ffffff,#fdebd0);">
    <div class="container">
      <a class="navbar-brand" href="/web/">æ—…éŠåŠ©æ‰‹</a>
      <div class="ms-auto">
        <button id="backBtn" class="btn btn-outline-secondary btn-sm">å›åˆ—è¡¨</button>
      </div>
    </div>
  </nav>

  <main class="container">
    <div class="chat-container shadow-sm rounded-3 p-3">
      <div class="row g-0">
        <div class="col-md-8 chat-area">
          <div id="llmPane" class="llm-pane p-3">
            <!-- LLM messages (left) -->
          </div>
        </div>
        <div class="col-md-4 chat-area bg-light border-start">
          <div id="userPane" class="user-pane p-3">
            <!-- User messages (right) -->
          </div>
        </div>
      </div>

      <div class="chat-input-bar mt-3 d-flex gap-2">
        <input id="chatInput" class="form-control" placeholder="è¼¸å…¥ä½ çš„å•é¡Œæˆ–æŒ‡ç¤ºï¼ˆä¾‹å¦‚ï¼šå¹«æˆ‘èª¿æ•´è¡Œç¨‹ï¼‰" />
        <button id="sendBtn" class="btn btn-primary">ğŸ’¬</button>
      </div>
    </div>
  </main>

  <script>
    // Simple chat UI logic (placeholder LLM responses)
    const params = new URLSearchParams(location.search);
    const tripId = params.get('trip') || params.get('tripId') || null;

    document.getElementById('backBtn').addEventListener('click', ()=>{ location.href = '/web/'; });

    const llmPane = document.getElementById('llmPane');
    const userPane = document.getElementById('userPane');
    const input = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');

    function appendLLM(text){
      const el = document.createElement('div');
      el.className = 'msg llm mb-3';
      el.innerHTML = `<div class="bubble">${text}</div>`;
      llmPane.appendChild(el);
      llmPane.scrollTop = llmPane.scrollHeight;
    }
    function appendUser(text){
      const el = document.createElement('div');
      el.className = 'msg user mb-3 text-end';
      el.innerHTML = `<div class="bubble user-bubble d-inline-block">${text}</div>`;
      userPane.appendChild(el);
      userPane.scrollTop = userPane.scrollHeight;
    }

    sendBtn.addEventListener('click', async ()=>{
      const txt = input.value.trim(); if(!txt) return; input.value = '';
      appendUser(txt);
      // Simulate LLM typing / response
      appendLLM('<i>æ€è€ƒä¸­â€¦</i>');
      setTimeout(()=>{
        // replace last LLM placeholder
        const last = llmPane.querySelector('.llm:last-child .bubble');
        if(last) last.innerHTML = `ï¼ˆtrip ${tripId || 'N/A'}ï¼‰æˆ‘æ”¶åˆ°ä½ çš„æŒ‡ç¤ºï¼š<strong>${txt}</strong>ï¼›é€™è£¡ç¤ºç¯„å›è¦†ï¼Œä½ å¯ä»¥é€²ä¸€æ­¥è¦æ±‚ä¿®æ”¹è¡Œç¨‹æˆ–åŠ å…¥æ™¯é»ã€‚`;
        // also append a follow-up suggestion
        appendLLM('å»ºè­°ï¼šè¦æˆ‘æŠŠç¬¬ 2 æ—¥èª¿æ•´ç‚ºåŠæ—¥è¼•é¬†è¡Œç¨‹å—ï¼Ÿ');
      }, 900);
    });

    // If you want, pre-populate an initial assistant message
    appendLLM(`æ­¡è¿ï¼${tripId ? 'æ­£åœ¨ç·¨è¼¯è¡Œç¨‹ ID: ' + tripId : 'å°šæœªæŒ‡å®šè¡Œç¨‹' }ï¼Œè«‹è¼¸å…¥ä½ çš„éœ€æ±‚æˆ–å•é¡Œã€‚`);
  </script>
</body>
</html>
